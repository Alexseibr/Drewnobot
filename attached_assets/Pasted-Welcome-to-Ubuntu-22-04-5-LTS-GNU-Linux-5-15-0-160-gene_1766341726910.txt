Welcome to Ubuntu 22.04.5 LTS (GNU/Linux 5.15.0-160-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

Failed to automatically attach to an Ubuntu Pro subscription 6 time(s).
The failure was due to: "Unable to determine cloud platform.".
The next attempt is scheduled for 2025-12-21T22:04:00+03:00.
You can try manually with `sudo pro auto-attach`.

New release '24.04.3 LTS' available.
Run 'do-release-upgrade' to upgrade to it.

Last login: Sun Dec 21 15:46:20 2025 from 46.216.172.197
root@server-srekbm:~# # Клонируйте репозиторий
cd /var/www
git clone https://github.com/Alexseibr/Drewnobot.git drewno-ops
cd drewno-ops

# Установите Node.js (если нет)
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs

# Установите зависимости
npm install

# Создайте .env файл
nano .env
Cloning into 'drewno-ops'...
remote: Enumerating objects: 262, done.
remote: Counting objects: 100% (262/262), done.
remote: Compressing objects: 100% (131/131), done.
remote: Total 262 (delta 117), reused 261 (delta 116), pack-reused 0 (from 0)
Receiving objects: 100% (262/262), 368.73 KiB | 3.84 MiB/s, done.
Resolving deltas: 100% (117/117), done.
2025-12-21 21:24:33 - Installing pre-requisites
Hit:1 http://mirror.datacenter.by/ubuntu jammy InRelease
Get:2 http://mirror.datacenter.by/ubuntu jammy-updates InRelease [128 kB]Get:3 http://mirror.datacenter.by/ubuntu jammy-proposed InRelease [279 kB]
Get:4 http://mirror.datacenter.by/ubuntu jammy-backports InRelease [127 kB]
Hit:5 http://archive.canonical.com/ubuntu jammy InRelease
Hit:6 https://deb.nodesource.com/node_20.x nodistro InRelease
Get:7 http://security.ubuntu.com/ubuntu jammy-security InRelease [129 kB]
Get:8 http://mirror.datacenter.by/ubuntu jammy-backports/main amd64 Packages [69.4 kB]
Get:9 http://mirror.datacenter.by/ubuntu jammy-backports/universe amd64 Packages [31.7 kB]
Fetched 765 kB in 1s (605 kB/s)
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
All packages are up to date.
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
ca-certificates is already the newest version (20240203~22.04.1).
curl is already the newest version (7.81.0-1ubuntu1.21).
gnupg is already the newest version (2.2.27-3ubuntu2.4).
apt-transport-https is already the newest version (2.4.14).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
Hit:1 http://mirror.datacenter.by/ubuntu jammy InRelease
Hit:2 http://mirror.datacenter.by/ubuntu jammy-updates InRelease
Hit:3 http://mirror.datacenter.by/ubuntu jammy-proposed InRelease
Hit:4 http://mirror.datacenter.by/ubuntu jammy-backports InRelease
Hit:5 http://security.ubuntu.com/ubuntu jammy-security InRelease
Hit:6 https://deb.nodesource.com/node_20.x nodistro InRelease
Hit:7 http://archive.canonical.com/ubuntu jammy InRelease
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
All packages are up to date.
2025-12-21 21:24:40 - Repository configured successfully.
2025-12-21 21:24:40 - To install Node.js, run: apt install nodejs -y
2025-12-21 21:24:40 - You can use N|solid Runtime as a node.js alternative
2025-12-21 21:24:40 - To install N|solid Runtime, run: apt install nsolid -y

Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
nodejs is already the newest version (20.19.6-1nodesource1).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.

added 478 packages, and audited 479 packages in 14s

67 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities
root@server-srekbm:/var/www/drewno-ops#
root@server-srekbm:/var/www/drewno-ops# npm run build
npm install -g pm2
pm2 start npm --name "drewno" -- start

> rest-express@1.0.0 build
> tsx script/build.ts

building client...
vite v7.3.0 building client environment for production...
transforming (1) src/main.tsx
A PostCSS plugin did not pass the `from` option to `postcss.parse`. This may cause imported assets to be incorrectly transformed. If you've recently added a PostCSS plugin that raised this warning, please contact the package author to fix the issue.
✓ 2577 modules transformed.
../dist/public/index.html                   1.00 kB │ gzip:   0.51 kB
../dist/public/assets/index-COmi3pf0.css   73.87 kB │ gzip:  12.00 kB
../dist/public/assets/index-C1WeF8QM.js   620.53 kB │ gzip: 178.88 kB

(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
✓ built in 13.67s
building server...

  dist/index.cjs  943.7kb

⚡ Done in 448ms

changed 133 packages in 11s

13 packages are looking for funding
  run `npm fund` for details

                        -------------

__/\\\\\\\\\\\\\____/\\\\____________/\\\\____/\\\\\\\\\_____
 _\/\\\/////////\\\_\/\\\\\\________/\\\\\\__/\\\///////\\\___
  _\/\\\_______\/\\\_\/\\\//\\\____/\\\//\\\_\///______\//\\\__
   _\/\\\\\\\\\\\\\/__\/\\\\///\\\/\\\/_\/\\\___________/\\\/___
    _\/\\\/////////____\/\\\__\///\\\/___\/\\\________/\\\//_____
     _\/\\\_____________\/\\\____\///_____\/\\\_____/\\\//________
      _\/\\\_____________\/\\\_____________\/\\\___/\\\/___________
       _\/\\\_____________\/\\\_____________\/\\\__/\\\\\\\\\\\\\\\_
        _\///______________\///______________\///__\///////////////__


                          Runtime Edition

        PM2 is a Production Process Manager for Node.js applications
                     with a built-in Load Balancer.

                Start and Daemonize any application:
                $ pm2 start app.js

                Load Balance 4 instances of api.js:
                $ pm2 start api.js -i 4

                Monitor in production:
                $ pm2 monitor

                Make pm2 auto-boot at server restart:
                $ pm2 startup

                To go further checkout:
                http://pm2.io/


                        -------------

[PM2] Spawning PM2 daemon with pm2_home=/root/.pm2
[PM2] PM2 Successfully daemonized
[PM2] Starting /usr/bin/npm in fork_mode (1 instance)
[PM2] Done.
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 0  │ drewno             │ fork     │ 0    │ online    │ 0%       │ 30.2mb   │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
root@server-srekbm:/var/www/drewno-ops# sudo nano /etc/nginx/sites-available/d.drewno.by
root@server-srekbm:/var/www/drewno-ops# sudo ln -s /etc/nginx/sites-available/d.drewno.by /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
root@server-srekbm:/var/www/drewno-ops# # Создайте .env файл
cat > /var/www/drewno-ops/.env << EOF
TELEGRAM_BOT_TOKEN=7409502547:AAEIpGl2VdyNmC92q7NLrMDhSqMZiQqNCPA
SESSION_SECRET=drewno-secret-key-2024
NODE_ENV=production
PORT=5000
EOF

# Перезапустите приложение
pm2 restart drewno

# Проверьте статус
pm2 logs drewno --lines 20
Use --update-env to update environment variables
[PM2] Applying action restartProcessId on app [drewno](ids: [ 0 ])
[PM2] [drewno](0) ✓
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 0  │ drewno             │ fork     │ 1    │ online    │ 0%       │ 25.3mb   │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
[TAILING] Tailing last 20 lines for [drewno] process (change the value with --lines option)
/root/.pm2/logs/drewno-error.log last 20 lines:
/root/.pm2/logs/drewno-out.log last 20 lines:
0|drewno   |
0|drewno   | > rest-express@1.0.0 start
0|drewno   | > NODE_ENV=production node dist/index.cjs
0|drewno   |
0|drewno   | 9:26:00 PM [express] serving on port 5000

0|drewno  | > rest-express@1.0.0 start
0|drewno  | > NODE_ENV=production node dist/index.cjs
0|drewno  | 9:27:58 PM [express] serving on port 5000

curl "https://api.telegram.org/bot7409502547:AAEIpGl2VdyNmC92q7NLrMDhSqMZiQqNCPA/setWebhook?url=https://d.drewno.by/api/telegram/webhook"curl "https://api.telegram.org/bot7409502547:AAEIpGl2VdyNmC92q7NLrMDhSqMZiQqNCPA/setWebhook?url=https://d.drewno.by/api/telegram/webhook"