ROLE: You are Replit AI acting as a senior full-stack engineer. Implement “Smart Thermostat Control” automation for the Drewno admin module. Goal: admins can (1) answer a daily 12:00 prompt about expected check-ins for houses 1–4, (2) the system schedules thermostat temperature changes accordingly, (3) admins can override anytime when a new booking arrives.

IMPORTANT
- Do NOT break existing functionality.
- Add code with minimal invasive changes.
- Add unit/integration tests where possible.
- Add clear logs and an Admin UI page.
- If the repo already has scheduling/queues (BullMQ/Redis/cron), reuse them. If not, add a safe scheduler approach.
- Make “thermostat provider” pluggable: start with a MOCK provider (no real Tuya yet) + an interface so later we can plug Tuya SmartLife/Tuya IoT.
- Use Europe/Minsk timezone (or project default if exists). Ensure “12:00, 14:30, 15:00” are timezone-correct.
- We have 4 houses: House 1,2,3,4.
- Temperatures:
  - If CHECK-IN TODAY: keep 16°C until 15:00, then start heating at 14:30 to reach 22°C by check-in time (we’ll implement as setpoint 22°C at 14:30).
  - If NO CHECK-IN TODAY: set 15°C (energy saving).
  - If GUESTS STAYING (multi-day): do nothing (keep current schedule / no changes).
- Manual override: at any time admin can press “Start heating now” for a specific house (e.g., booking just arrived), which will set 22°C immediately (or at least trigger the “check-in heating” flow now).

DELIVERABLES
1) Backend:
   - New data models / tables (or Mongo collections) for:
     a) Houses registry (if not present): houseId, name, thermostatDeviceId (string), providerConfig (json).
     b) DailyPlan: date, houseId, planType enum {CHECKIN_TODAY, NO_CHECKIN, GUESTS_STAYING}, setByAdminUserId, setAt.
     c) ThermostatActionLog: ts, houseId, actionType, targetTemp, result, error, correlationId, triggeredBy {SCHEDULED|MANUAL|SYSTEM}.
   - Scheduler:
     - At 12:00 daily: create or refresh “DailyPlan prompt” status for today; notify admin in Admin UI (and if there is already notification system—reuse it).
     - At 14:30 daily: for each house with planType CHECKIN_TODAY -> set temp to 22°C.
     - At 15:00 daily: ensure houses with planType CHECKIN_TODAY are not below 16°C earlier than 15:00; (implementation: at 12:05 set 16°C for CHECKIN_TODAY houses; at 15:00 no additional action needed except sanity).
     - At 12:05 daily: apply base temps:
         * CHECKIN_TODAY -> set 16°C
         * NO_CHECKIN -> set 15°C
         * GUESTS_STAYING -> do nothing
     - Make all scheduled jobs idempotent (safe to run twice).
     - Prefer Redis/BullMQ if exists; otherwise use node-cron with persistence checks in DB.
   - Thermostat Provider abstraction:
     - Create interface IThermostatProvider with:
         * getStatus(houseId): {currentTemp, targetTemp, mode, online}
         * setTargetTemp(houseId, tempC, reason)
     - Implement MockThermostatProvider that stores status in DB (or memory + DB fallback) so we can test end-to-end without Tuya.
     - Add env var THERMOSTAT_PROVIDER=mock (default).
     - Add placeholder TuyaThermostatProvider with TODO methods and clear error messages (not wired by default).
   - API endpoints (secure, admin only):
     - GET  /api/admin/thermostats/houses -> list houses + latest status + today plan
     - POST /api/admin/thermostats/plan/today -> body: { houseId: 1..4, planType } (bulk allowed)
     - POST /api/admin/thermostats/houses/:houseId/heat-now -> sets 22°C immediately + logs MANUAL
     - POST /api/admin/thermostats/houses/:houseId/set-temp -> sets custom temp (optional feature but useful)
     - GET  /api/admin/thermostats/logs?houseId&date -> action logs
   - Validation:
     - houseId must be 1..4
     - temp range safe: 5..35
   - Observability:
     - Structured logs: [ThermostatScheduler] and [ThermostatProvider]
     - CorrelationId per run

2) Frontend (Admin UI):
   - Add a new page: “Умный дом / Термостаты”
   - At top: today’s date + status “Опрос на сегодня заполнен/не заполнен”.
   - For each house card (1..4):
     - Current status (online/offline), currentTemp, targetTemp.
     - Selector with 3 options:
       1) “Сегодня будет заселение” (CHECKIN_TODAY)
       2) “Сегодня заселения не будет” (NO_CHECKIN)
       3) “Гости живут несколько дней (ничего не менять)” (GUESTS_STAYING)
     - Button: “Сохранить план”
     - Button: “Начать греть сейчас (22°C)” (heat-now)
     - Optional: small input “Установить вручную” temp + apply
   - Logs section: last 20 actions (per selected house).
   - UX requirements:
     - Confirm dialog for “heat now”
     - Show success/error toast
     - Don’t block existing admin navigation.

3) Tests:
   - Unit tests for scheduler decision logic (given plans -> expected setTargetTemp calls at 12:05/14:30).
   - API tests for validation and auth (as existing test infra allows).
   - Mock provider tests.

IMPLEMENTATION STEPS (follow strictly)
A) Inspect repo:
   - Identify backend framework (Express/Nest) and DB (Mongo/Postgres/etc).
   - Identify existing auth/roles for admin.
   - Identify existing scheduler/queue tool (cron/BullMQ).
B) Implement data models and migrations (if SQL) or collection schemas (if Mongo).
C) Implement provider interface + mock provider.
D) Implement scheduler jobs:
   - Job names:
     - thermostat_daily_base_1205
     - thermostat_daily_heat_1430
     - thermostat_daily_prompt_1200
   - Ensure idempotency: check ThermostatActionLog for same houseId+actionType+date+timeWindow before writing duplicates.
E) Implement admin API routes/controllers + validation.
F) Implement admin UI page with API integration.
G) Add tests.
H) Add docs: docs/smartlife-thermostat.md describing how to later connect Tuya IoT (placeholders, required credentials, mapping device schema).
I) Provide a short summary in PR notes: what changed, how to run, how to test.

EDGE CASES
- If admin hasn’t answered by 14:30: default behavior = NO_CHANGE (do nothing) + show warning in UI.
- If house is offline: log failure; scheduler retries 3 times with exponential backoff (5m, 15m, 30m).
- If admin changes plan during the day: re-apply base temp immediately (for CHECKIN_TODAY -> 16°C; for NO_CHECKIN -> 15°C) unless time is already past 14:30 and they set CHECKIN_TODAY -> then trigger heat-now logic to 22°C.
- Manual “heat-now” always overrides for the next 6 hours, but must not permanently change future plans.

ACCEPTANCE CRITERIA
- At 12:00, UI clearly indicates we need to answer for houses 1–4.
- Admin sets plan types; at 12:05 the system applies 16/15/do-nothing as specified.
- At 14:30, houses marked CHECKIN_TODAY receive setpoint 22°C.
- Admin can press “heat now” anytime and it applies immediately.
- All actions are logged and visible.
- No existing functionality is broken.

Now implement it end-to-end in the current codebase with correct file paths, code style, and working build.
